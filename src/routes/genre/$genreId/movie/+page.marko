import { getMediaByGenre } from "../../../../services/tmdb";
import { object, number, coerce, integer, minValue, parse } from "valibot";
import loader from "./loader.marko";
$ const parseResult = parse(
  object({ genreId: coerce(number([minValue(0), integer()]), Number) }),
  $global.params
);
$ const movies = getMediaByGenre({
  context: $global.tmdb,
  genre: parseResult.genreId,
  media: "movie",
  page: 1,
});

<await(movies)>
  <@then|movies|>

    <loader
      genreId=parseResult.genreId
      initialCollection=movies
      name=`Movie Genre: ${movies?.genre?.name || "Not defined"}`
    />
  </@then>
</await>
